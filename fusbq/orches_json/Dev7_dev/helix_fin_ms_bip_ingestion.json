{
  "dag_config": {
    "dag_id": "helix_fin_ms_bip_ingestion",
    "owner": "IT-Finance-Analytics-Dev-Team",
    "start_date": "2023-05-30",
    "schedule_interval": null,
    "time_zone": "Asia/Bangkok",
    "depends_on_past": false,
    "retries": 2,
    "retry_delay": 60,
    "email": [
      "IT-Finance-Analytics-Dev@equinix.com"
    ],
    "email_on_failure": true,
    "email_on_retry": false,
    "sla": 60,
    "tags": [
      "fusion-ingestion-orchfw"
    ],
    "tags_for_batch_holds": [
      "FUSION-MS",
      "FUSION-ALL"
    ],
    "framework_version": "v1.0"
  },
  "task_config": {
    "airflow_variable_id_for_impersonation_chain": "helix-orchestrator-fusion-impersonation-chain-json-list",
    "data_project_id": "helix-data-dev",
    "tasks": [
      {
        "task_name": "UCM_TO_GCS",
        "task_type": "EXECUTION",
        "template_reference": "FUSION_UCM2GCS",
        "config": {
            "parameters": {},
            "environment": {}
        }
    },
    {
        "task_name": "LOAD_UCM_FILE_EXTRACT",
        "template_reference": "FUSION_GCS2BQ_UCM",
        "task_type": "EXECUTION",
        "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": "ms_inbound/metadata_table/*",
            "schema_object": "fusion_schema/BICC_UCM_FILE_EXTRACT.json",
            "destination_project_dataset_table": "helix-data-dev.BQ_DM.BICC_UCM_FILE_EXTRACT"
        },
        "upstream_tasks": [
            "UCM_TO_GCS"
        ]
    },
    {
        "task_name": "LOAD_UCM_JSON_DETAIL",
        "template_reference": "FUSION_GCS2BQ_UCM",
        "task_type": "EXECUTION",
        "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": "ms_inbound/metadata_json/*",
            "schema_object": "fusion_schema/BICC_UCM_JSON_DETAILS.json",
            "destination_project_dataset_table": "helix-data-dev.BQ_DM.BICC_UCM_JSON_DETAILS"
        },
        "upstream_tasks": [
            "UCM_TO_GCS"
        ]
        },
        {
          "task_name": "MS_BIP_001_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HZ_ORG_CONTACTS*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HZ_ORG_CONTACTS_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HZ_ORG_CONTACTS_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_002_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HZ_CUST_SITE_USES_ALL*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HZ_CUST_SITE_USES_ALL_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HZ_CUST_SITE_USES_ALL_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_003_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HZ_CUST_ACCT_SITES_ALL*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HZ_CUST_ACCT_SITES_ALL_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HZ_CUST_ACCT_SITES_ALL_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_004_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HZ_CUST_ACCOUNTS*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HZ_CUST_ACCOUNTS_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HZ_CUST_ACCOUNTS_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_005_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HZ_LOCATIONS*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HZ_LOCATIONS_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HZ_LOCATIONS_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_006_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HZ_PARTY_SITES*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HZ_PARTY_SITES_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HZ_PARTY_SITES_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_007_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/AR_LOOKUPS*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_AR_LOOKUPS_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_AR_LOOKUPS_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_008_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/FND_DOCUMENT_SEQUENCES*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_FND_DOCUMENT_SEQUENCES_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_FND_DOCUMENT_SEQUENCES_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_009_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HR_ORGANIZATION_INFORMATION_F*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HR_ORGANIZATION_INFORMATION_F_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HR_ORGANIZATION_INFORMATION_F_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_010_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HR_ALL_ORGANIZATION_UNITS_TL*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HR_ALL_ORGANIZATION_UNITS_TL_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HR_ALL_ORGANIZATION_UNITS_TL_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_011_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/FUN_ALL_BUSINESS_UNITS_V*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_FUN_ALL_BUSINESS_UNITS_V_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_FUN_ALL_BUSINESS_UNITS_V_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_012_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HR_ORG_UNIT_CLASSIFICATIONS_F*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HR_ORG_UNIT_CLASSIFICATIONS_F_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HR_ORG_UNIT_CLASSIFICATIONS_F_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_013_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HR_OPERATING_UNITS*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HR_OPERATING_UNITS_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HR_OPERATING_UNITS_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_014_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HZ_CONTACT_POINTS*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HZ_CONTACT_POINTS_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HZ_CONTACT_POINTS_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_015_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HZ_ROLE_RESPONSIBILITY*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HZ_ROLE_RESPONSIBILITY_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HZ_ROLE_RESPONSIBILITY_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_016_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HZ_PARTIES*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HZ_PARTIES_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HZ_PARTIES_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_017_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HR_ORGANIZATION_UNITS_F_TL*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HR_ORGANIZATION_UNITS_F_TL_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HR_ORGANIZATION_UNITS_F_TL_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_018_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HZ_CUST_ACCOUNT_ROLES*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HZ_CUST_ACCOUNT_ROLES_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HZ_CUST_ACCOUNT_ROLES_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_019_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/GL_DAILY_RATES*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_GL_DAILY_RATES_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_GL_DAILY_RATES_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_020_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/GL_TRANSLATION_RATES*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_GL_TRANSLATION_RATES_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_GL_TRANSLATION_RATES_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_021_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HR_LOCATIONS*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HR_LOCATIONS_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HR_LOCATIONS_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_022_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/PER_USER_PERSON_NAME*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_PER_USER_PERSON_NAME_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_PER_USER_PERSON_NAME_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_023_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/PO_LOOKUP_CODES*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_PO_LOOKUP_CODES_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_PO_LOOKUP_CODES_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_024_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/AP_LOOKUP_CODES*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_AP_LOOKUP_CODES_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_AP_LOOKUP_CODES_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_025_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/AP_HOLD_CODES*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_AP_HOLD_CODES_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_AP_HOLD_CODES_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_026_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/HZ_CODE_ASSIGNMENTS*.csv"
            ],
            "schema_object": "fusion_schema/STG_MS_HZ_CODE_ASSIGNMENTS_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_MS_HZ_CODE_ASSIGNMENTS_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_027_STG_LOAD",
          "template_reference": "FUSION_GCS2BQ",
          "task_type": "EXECUTION",
          "config": {
            "bucket": "helix-fin-oc-ms-dev",
            "source_objects": [
              "ms_bip_inbound/CE_BANK_BRANCHES_V*.csv"
            ],
            "schema_object": "fusion_schema/STG_DEL_MS_CE_BANK_BRANCHES_V_BIP.json",
            "destination_project_dataset_table": "helix-data-dev.helix_fin_ms_stg.STG_DEL_MS_CE_BANK_BRANCHES_V_BIP"
          },
          "upstream_tasks": [
            "LOAD_UCM_FILE_EXTRACT",
            "LOAD_UCM_JSON_DETAIL"
          ]
        },
        {
          "task_name": "MS_BIP_001_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HZ_ORG_CONTACTS_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HZ_ORG_CONTACTS_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HZ_ORG_CONTACTS_BIP",
            "primary_key_columns": "ORG_CONTACT_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_001_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_002_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HZ_CUST_SITE_USES_ALL_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HZ_CUST_SITE_USES_ALL_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HZ_CUST_SITE_USES_ALL_BIP",
            "primary_key_columns": "SITE_USE_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_002_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_003_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HZ_CUST_ACCT_SITES_ALL_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HZ_CUST_ACCT_SITES_ALL_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HZ_CUST_ACCT_SITES_ALL_BIP",
            "primary_key_columns": "CUST_ACCT_SITE_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_003_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_004_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HZ_CUST_ACCOUNTS_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HZ_CUST_ACCOUNTS_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HZ_CUST_ACCOUNTS_BIP",
            "primary_key_columns": "CUST_ACCOUNT_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_004_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_005_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HZ_LOCATIONS_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HZ_LOCATIONS_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HZ_LOCATIONS_BIP",
            "primary_key_columns": "LOCATION_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_005_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_006_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HZ_PARTY_SITES_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HZ_PARTY_SITES_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HZ_PARTY_SITES_BIP",
            "primary_key_columns": "PARTY_SITE_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_006_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_007_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_AR_LOOKUPS_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_AR_LOOKUPS_BIP",
            "raw_table": "helix_fin_ms_raw.MS_AR_LOOKUPS_BIP",
            "primary_key_columns": "LOOKUP_TYPE,LOOKUP_CODE",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_007_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_008_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_FND_DOCUMENT_SEQUENCES_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_FND_DOCUMENT_SEQUENCES_BIP",
            "raw_table": "helix_fin_ms_raw.MS_FND_DOCUMENT_SEQUENCES_BIP",
            "primary_key_columns": "DOC_SEQUENCE_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_008_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_009_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HR_ORGANIZATION_INFORMATION_F_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HR_ORGANIZATION_INFORMATION_F_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HR_ORGANIZATION_INFORMATION_F_BIP",
            "primary_key_columns": "ORG_INFORMATION_ID,EFFECTIVE_START_DATE,EFFECTIVE_END_DATE",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_009_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_010_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HR_ALL_ORGANIZATION_UNITS_TL_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HR_ALL_ORGANIZATION_UNITS_TL_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HR_ALL_ORGANIZATION_UNITS_TL_BIP",
            "primary_key_columns": "ORGANIZATION_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_010_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_011_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_FUN_ALL_BUSINESS_UNITS_V_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_FUN_ALL_BUSINESS_UNITS_V_BIP",
            "raw_table": "helix_fin_ms_raw.MS_FUN_ALL_BUSINESS_UNITS_V_BIP",
            "primary_key_columns": "BU_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_011_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_012_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HR_ORG_UNIT_CLASSIFICATIONS_F_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HR_ORG_UNIT_CLASSIFICATIONS_F_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HR_ORG_UNIT_CLASSIFICATIONS_F_BIP",
            "primary_key_columns": "ORG_UNIT_CLASSIFICATION_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_012_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_013_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HR_OPERATING_UNITS_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HR_OPERATING_UNITS_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HR_OPERATING_UNITS_BIP",
            "primary_key_columns": "ORGANIZATION_ID,BUSINESS_GROUP_ID,SET_OF_BOOKS_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_013_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_014_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HZ_CONTACT_POINTS_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HZ_CONTACT_POINTS_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HZ_CONTACT_POINTS_BIP",
            "primary_key_columns": "CONTACT_POINT_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_014_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_015_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HZ_ROLE_RESPONSIBILITY_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HZ_ROLE_RESPONSIBILITY_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HZ_ROLE_RESPONSIBILITY_BIP",
            "primary_key_columns": "RESPONSIBILITY_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_015_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_016_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HZ_PARTIES_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HZ_PARTIES_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HZ_PARTIES_BIP",
            "primary_key_columns": "PARTY_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_016_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_017_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HR_ORGANIZATION_UNITS_F_TL_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HR_ORGANIZATION_UNITS_F_TL_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HR_ORGANIZATION_UNITS_F_TL_BIP",
            "primary_key_columns": "ORGANIZATION_ID,EFFECTIVE_START_DATE,EFFECTIVE_END_DATE",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_017_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_018_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HZ_CUST_ACCOUNT_ROLES_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HZ_CUST_ACCOUNT_ROLES_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HZ_CUST_ACCOUNT_ROLES_BIP",
            "primary_key_columns": "CUST_ACCOUNT_ROLE_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_018_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_019_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_GL_DAILY_RATES_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_GL_DAILY_RATES_BIP",
            "raw_table": "helix_fin_ms_raw.MS_GL_DAILY_RATES_BIP",
            "primary_key_columns": "CONVERSION_TYPE,FROM_CURRENCY,TO_CURRENCY,CONVERSION_DATE",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_019_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_020_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_GL_TRANSLATION_RATES_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_GL_TRANSLATION_RATES_BIP",
            "raw_table": "helix_fin_ms_raw.MS_GL_TRANSLATION_RATES_BIP",
            "primary_key_columns": "FROM_CURCY_CD,TO_CURCY_CD,EFFECTIVE_FROM_DT,EFFECTIVE_END_DT,RATE_TYPE",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_020_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_021_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HR_LOCATIONS_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HR_LOCATIONS_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HR_LOCATIONS_BIP",
            "primary_key_columns": "LOCATION_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_021_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_022_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_PER_USER_PERSON_NAME_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_PER_USER_PERSON_NAME_BIP",
            "raw_table": "helix_fin_ms_raw.MS_PER_USER_PERSON_NAME_BIP",
            "primary_key_columns": "PERSON_ID",
            "incremental_date_columns": "PERSON_ID"
          },
          "upstream_tasks": [
            "MS_BIP_022_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_023_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_PO_LOOKUP_CODES_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_PO_LOOKUP_CODES_BIP",
            "raw_table": "helix_fin_ms_raw.MS_PO_LOOKUP_CODES_BIP",
            "primary_key_columns": "LOOKUP_CODE,LOOKUP_TYPE",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_023_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_024_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_AP_LOOKUP_CODES_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_AP_LOOKUP_CODES_BIP",
            "raw_table": "helix_fin_ms_raw.MS_AP_LOOKUP_CODES_BIP",
            "primary_key_columns": "LOOKUP_CODE,LOOKUP_TYPE",
            "incremental_date_columns": "LOOKUP_CODE"
          },
          "upstream_tasks": [
            "MS_BIP_024_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_025_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_AP_HOLD_CODES_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_AP_HOLD_CODES_BIP",
            "raw_table": "helix_fin_ms_raw.MS_AP_HOLD_CODES_BIP",
            "primary_key_columns": "HOLD_LOOKUP_CODE",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_025_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_026_MERGE",
          "template_reference": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_MS_HZ_CODE_ASSIGNMENTS_BIP",
            "dl_table": "helix_fin_ms_dl.DL_MS_HZ_CODE_ASSIGNMENTS_BIP",
            "raw_table": "helix_fin_ms_raw.MS_HZ_CODE_ASSIGNMENTS_BIP",
            "primary_key_columns": "CODE_ASSIGNMENT_ID",
            "incremental_date_columns": "LAST_UPDATE_DATE"
          },
          "upstream_tasks": [
            "MS_BIP_026_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "MS_BIP_027_MERGE",
          "template_reference": "FUSION-SOFT-DEL-MERGE-1",
          "task_type": "MERGE",
          "config": {
            "stg_table": "helix_fin_ms_stg.STG_DEL_MS_CE_BANK_BRANCHES_V_BIP",
            "raw_table": "helix_fin_ms_raw.MS_CE_BANK_BRANCHES_V_BIP",
            "primary_key_columns": null,
            "incremental_date_columns": null
          },
          "upstream_tasks": [
            "MS_BIP_027_STG_LOAD"
          ],
          "downstream_tasks": [
            "ARCHIVE_FILES"
          ]
        },
        {
          "task_name": "ARCHIVE_FILES",
          "task_type": "EXECUTION",
          "template_reference": "GCS_TO_GCS_ARCHIVE",
          "config": {}
        }
    ]
  },
  "template_config": {
    "merge_templates": [
      {
        "template_id": "FUSION_DATA_MERGE_STG_TO_DL_AND_RAW",
        "merge_type": "MERGE_UPDATE",
        "config": {
          "primary_key_columns": "",
          "incremental_date_columns": "",
          "truncate_stg_table": "True"
        },
        "lag_minutes": 0
      },
      {
        "template_id": "FUSION-SOFT-DEL-MERGE-1",
        "merge_type": "UPDATE_SD_ALL_PK",
        "config": {
          "primary_key_columns": "",
          "incremental_date_columns": ""
        },
        "lag_minutes": 0
      }
    ],
    "execution_templates": [
      {
        "template_id": "FUSION_UCM2GCS",
        "execution_type": "DATAFLOW",
        "config":
        {
          "dataflow_template_location": "gs://eqx-helix-fusion-dev/templates/fusiontogcp_dev_integrated_version_3.json",
          "parameters":
          {
            "projectId": "it-helix-platform-dev",
            "bucketName": "helix-fin-oc-ms-dev",
            "inboundFolderPath": "ms_bip_inbound",
            "currentFolderPath": "current_run_ms_bip",
            "currentFolderDecryptedPath":"Decrypted_Folder_gpg_ms_bip",
            "jsonToCsvFolderPath": "ms_bip_inbound/metadata_json",
            "metadataToCsvFolderPath": "ms_bip_inbound/metadata_table",
            "controlScheduleTableName": "helix-data-dev.BQ_CTL_METADATA.BQ_CTL_PROC_LOGGING",
            "soapEndPointUrl": "https://fa-etfl-dev7-saasfaprod1.fa.ocs.oraclecloud.com:443/idcws/GenericSoapPort",
            "soapAction": "soapAction for the pipeline",
            "soapEnv": "http://schemas.xmlsoap.org/soap/envelope/",
            "soapUcm": "http://www.oracle.com/UCM",
            "username": "eqx_helix",
            "secret": "oracle-fusion-dev7-password",
            "bipFiles":"NOFILE",
            "incrementalBipFiles": "HZ_ORG_CONTACTS,HZ_CUST_SITE_USES_ALL,HZ_CUST_ACCT_SITES_ALL,HZ_CUST_ACCOUNTS,HZ_LOCATIONS,HZ_PARTY_SITES,AR_LOOKUPS,FND_DOCUMENT_SEQUENCES,HR_ORGANIZATION_INFORMATION_F,HR_ALL_ORGANIZATION_UNITS_TL,FUN_ALL_BUSINESS_UNITS_V,HR_ORG_UNIT_CLASSIFICATIONS_F,HR_OPERATING_UNITS,HZ_CONTACT_POINTS,HZ_ROLE_RESPONSIBILITY,HZ_PARTIES,HR_ORGANIZATION_UNITS_F_TL,HZ_CUST_ACCOUNT_ROLES,GL_DAILY_RATES,GL_TRANSLATION_RATES,HR_LOCATIONS,PER_USER_PERSON_NAME,PO_LOOKUP_CODES,AP_LOOKUP_CODES,AP_HOLD_CODES,HZ_CODE_ASSIGNMENTS",
            "biccScheduleNames": "helix_fin_ms_data_extract_schedule",
            "bipDagRunId": "{{ get_audit_param('dag_run_id') }}",
            "bipLastRunTime":"{{ get_audit_param('from_delta_key') }}",
            "currentTime":"{{ get_audit_param('to_delta_key') }}",
            "pgpSecretIdForPublicKey": "oracle-dev7-publickey",
            "pgpSecretIdForPrivateKey": "oracle-dev7-privatekey",
            "pgpSecretIdForPassphrase": "oracle-dev7-passphrase"
          },
          "environment": {
            "tempLocation": "gs://helix-fin-oc-ms-dev/dataflow/temp/fusion_ucm2gcs/",
            "stagingLocation": "gs://helix-fin-oc-ms-dev/dataflow/staging/fusion_ucm2gcs/",
            "subnetwork": "https://www.googleapis.com/compute/v1/projects/nonprod-shared-l2/regions/us-west1/subnetworks/eqx-non-prod-helix-platform-dev",
            "network": "eqx-nonprod",
            "numWorkers": 10,
            "maxWorkers": 100
          }
        },
        "lag_minutes": 0
      },
      {
        "template_id": "FUSION_GCS2BQ_UCM",
        "execution_type": "GCS_TO_BQ",
        "config": {
          "source_format": "CSV",
          "skip_leading_rows": "1",
          "autodetect": "False",
          "write_disposition": "WRITE_APPEND",
          "allow_quoted_newlines": "True",
          "retries": "0"
        }
      },
      {
          "template_id": "FUSION_GCS2BQ",
          "execution_type": "GCS_TO_BQ",
          "config": {
            "source_format": "CSV",
            "skip_leading_rows": "1",
            "autodetect": "False",
            "write_disposition": "WRITE_TRUNCATE",
            "allow_quoted_newlines": "True",
            "retries": "0"
          }
      },
      {
        "template_id": "SQL_DW_PROC_1",
        "execution_type": "SQL",
        "config": {
          "sql_statement_type": "MULTI_STATEMENT"
        },
        "lag_minutes": 0
      },
      {
          "template_id": "DAG_TRIGGER_TEMPLATE",
          "execution_type": "TRIGGER_DAG",
          "config": {},
          "lag_minutes": 0
      },
      {
        "template_id": "EXASOL_SYNC_DAG_TRIGGER",
        "execution_type": "TRIGGER_DAG",
        "config": {
          "trigger_dag_id": "bigquery_exasol_sync",
          "wait_for_completion": false,
          "parameters": {
            "batch_name": "AR_BQ_TO_EXASOL_SYNC",
            "etl_proc_wid": "{{ get_audit_param('dag_run_id') }}"
          }
        },
        "lag_minutes": 0
      },
      {
        "template_id": "GCS_TO_GCS_ARCHIVE",
        "execution_type": "GCS_TO_GCS",
        "config": {
          "source_bucket": "helix-fin-oc-ms-dev",
          "source_objects": [
            "ms_bip_inbound/*"
          ],
          "destination_bucket": "helix-fin-oc-ms-dev",
          "destination_object": "ms_bip_archive/{{ get_audit_param('dag_run_id') }}/",
          "move_object": true
        },
        "lag_minutes": 0
      }
    ]
  }
}